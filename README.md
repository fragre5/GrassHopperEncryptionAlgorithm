# Grasshopper Encryption Algorithm

[![Python Version](https://img.shields.io/badge/python-3.12%2B-blue)](https://www.python.org/)

Реализацию учебной версии алгоритма блочного шифрования «Кузнечик» на Python. 
Алгоритм разработан в рамках российского стандарта Р 34.12-2015 и включает в себя криптографические компоненты, такие как нелинейные S-блоки, линейные преобразования и генерация раундовых ключей.

## Описание алгоритма

Алгоритм «Кузнечик» является симметричным блочным шифром, который работает с блоками данных фиксированного размера (в данном варианте 8 байт). Основные этапы алгоритма включают:
- **Подстановка (S-блоки):** Применяются S-блоки для нелинейного преобразования данных. S-блок π₀ генерируется как случайная перестановка чисел от 0 до 255 с использованием значения мастер-ключа в качестве seed, а π₁ является обратной перестановкой.
- **Линейное преобразование (L):** Реализовано через повторное применение функции, основанной на циклическом сдвиге и вычислении XOR-суммы, что обеспечивает высокую диффузию.
- **Генерация раундовых ключей:** Мастер-ключ разбивается на две части, после чего по методу Фейстеля с использованием S-блоков и линейного преобразования генерируется 10 раундовых ключей.
- **Шифрование:** Выполняется в 9 полных раундах (каждый раунд включает операции XOR, подстановку и линейное преобразование) и завершается финальным раундом, состоящим только из операции XOR.
- **Дешифрование:** Обратный процесс, где применяются обратные операции (обратное линейное преобразование, обратная S-подстановка и XOR) для восстановления исходного текста.

### Работа с полем Галуа GF(2⁸)

Алгоритм использует арифметику в конечном поле Галуа GF(2⁸) для реализации умножения многочленов. Каждый элемент GF(2⁸) представлен как многочлен степени не выше 7 с коэффициентами 0 или 1.  
Для редукции (сведения результата умножения к элементу поля) применяется неприводимый полином **0x11B**, который в многочленном виде выглядит как:
  
> x⁸ + x⁴ + x³ + x + 1

Этот полином гарантирует, что результат умножения всегда будет представимым в 8 битах.

## Структура проекта

- **core/grasshopper_encryption.py:** Содержит реализацию основных функций алгоритма, таких как генерация S-блоков, линейное преобразование, операции умножения в GF(2⁸), генерация раундовых ключей, а также шифрование и дешифрование блоков.